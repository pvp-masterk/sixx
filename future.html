<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>System 7.0 // Enhanced</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg: #030304;
  --surface: rgba(20, 20, 25, 0.4);
  --border: rgba(255, 255, 255, 0.08);
  --accent: #00f3ff; /* Cyber Cyan */
  --accent-glow: rgba(0, 243, 255, 0.4);
  --primary: #7000ff; /* Deep Purple */
  --text: #ffffff;
  --text-muted: #7a7a85;
  
  /* Physics Constants */
  --ease-out-expo: cubic-bezier(0.19, 1, 0.22, 1);
  --ease-in-back: cubic-bezier(0.6, -0.28, 0.735, 0.045);
}

* { box-sizing: border-box; margin: 0; padding: 0; cursor: none; }

body {
  font-family: 'Inter', sans-serif;
  background-color: var(--bg);
  color: var(--text);
  overflow: hidden; /* App-like feel */
  height: 100vh; width: 100vw;
}

/* --- AMBIENCE --- */
.scanline {
  position: fixed; inset: 0; pointer-events: none; z-index: 9000;
  background: linear-gradient(to bottom, transparent 50%, rgba(0,0,0,0.3) 51%);
  background-size: 100% 4px;
  opacity: 0.6;
}
.vignette {
  position: fixed; inset: 0; pointer-events: none; z-index: 1;
  background: radial-gradient(circle at center, transparent 0%, #000 120%);
}
.bg-grid {
  position: fixed; inset: 0; z-index: 0;
  background-image: 
    linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
  background-size: 60px 60px;
  transform: perspective(1000px) rotateX(10deg) scale(1.5);
  transform-origin: top center;
  opacity: 0.5;
}

/* --- CURSOR --- */
#cursor {
  position: fixed; top: 0; left: 0; z-index: 9999; pointer-events: none;
  mix-blend-mode: difference;
}
.c-dot { width: 6px; height: 6px; background: white; border-radius: 50%; position: absolute; transform: translate(-50%, -50%); }
.c-ring { 
  width: 40px; height: 40px; border: 1px solid rgba(255,255,255,0.5); 
  border-radius: 50%; position: absolute; transform: translate(-50%, -50%);
  transition: width 0.2s, height 0.2s, border-color 0.2s;
}
body:hover .c-ring.active { width: 60px; height: 60px; border-color: var(--accent); background: rgba(255,255,255,0.05); }

/* --- LAYOUT & SCROLLING --- */
#app-root {
  height: 100%; overflow-y: auto; padding: 140px 5vw 100px 5vw;
  transition: transform 0.6s var(--ease-out-expo), filter 0.6s;
  /* Scrollbar Styling */
  scrollbar-width: thin;
  scrollbar-color: var(--accent) transparent;
}
/* Webkit Scrollbar */
#app-root::-webkit-scrollbar { width: 4px; }
#app-root::-webkit-scrollbar-track { background: transparent; }
#app-root::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 4px; box-shadow: 0 0 10px var(--accent); }

body.modal-open #app-root {
  transform: scale(0.92) translateY(-30px);
  filter: blur(8px) brightness(0.6);
  pointer-events: none;
}

/* --- NEW: ADVANCED SCROLL HUD --- */
.scroll-hud {
  position: fixed; top: 50%; right: 20px; transform: translateY(-50%);
  height: 300px; width: 40px; z-index: 100;
  display: flex; flex-direction: column; align-items: flex-end; justify-content: space-between;
  font-family: 'JetBrains Mono'; font-size: 10px; color: var(--accent);
  pointer-events: none; opacity: 0.7; transition: opacity 0.3s;
}
body.modal-open .scroll-hud { opacity: 0; }

.scroll-line {
  width: 1px; height: 100%; background: rgba(255,255,255,0.1);
  position: absolute; right: 10px; top: 0;
}
.scroll-progress {
  position: absolute; right: 10px; top: 0; width: 2px;
  background: var(--accent);
  height: 0%; /* JS controlled */
  box-shadow: 0 0 10px var(--accent);
  transition: height 0.1s;
}
.scroll-readout { margin-bottom: 10px; letter-spacing: 1px; }
/* Velocity Indicator */
.velocity-bar {
  width: 4px; height: 4px; background: #fff;
  border-radius: 2px; margin-right: 8px;
  transition: transform 0.1s, opacity 0.2s;
  transform-origin: center right;
}

/* --- NEW: COMMAND SEARCH BAR --- */
.search-wrapper {
  position: fixed; top: 30px; left: 50%; transform: translateX(-50%);
  z-index: 800; width: 300px;
  transition: width 0.4s var(--ease-out-expo), top 0.4s;
}
/* Focus State */
.search-wrapper.focused { width: 500px; }
body.modal-open .search-wrapper { top: -100px; }

.search-glass {
  position: relative;
  display: flex; align-items: center; gap: 15px;
  background: rgba(10, 10, 12, 0.6);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--border);
  border-radius: 50px;
  padding: 12px 20px;
  box-shadow: 0 10px 30px -5px rgba(0,0,0,0.5);
  transition: 0.3s;
}
.search-wrapper.focused .search-glass {
  border-color: var(--accent);
  box-shadow: 0 0 20px rgba(0, 243, 255, 0.15);
  background: rgba(10, 10, 12, 0.9);
}

.s-icon { color: var(--text-muted); transition: 0.3s; }
.search-wrapper.focused .s-icon { color: var(--accent); }

.s-input {
  background: transparent; border: none; outline: none;
  font-family: 'JetBrains Mono'; color: #fff; font-size: 14px;
  width: 100%; letter-spacing: 0.5px;
}
.s-input::placeholder { color: rgba(255,255,255,0.2); }

/* Command Key Hint */
.s-key {
  font-family: 'JetBrains Mono'; font-size: 10px; color: var(--text-muted);
  border: 1px solid var(--border); padding: 4px 8px; border-radius: 6px;
  background: rgba(255,255,255,0.03); white-space: nowrap;
  transition: 0.3s;
}
.search-wrapper.focused .s-key { opacity: 0; transform: translateX(10px); }

/* Animated Signal Visualizer (Hidden until typing) */
.s-signal {
  position: absolute; right: 20px; display: flex; gap: 3px;
  opacity: 0; transition: 0.3s;
}
.search-wrapper.typing .s-signal { opacity: 1; }

.sig-bar {
  width: 3px; height: 10px; background: var(--accent);
  border-radius: 2px;
  animation: signal 0.5s infinite alternate;
}
.sig-bar:nth-child(2) { animation-delay: 0.1s; height: 14px; }
.sig-bar:nth-child(3) { animation-delay: 0.2s; }
@keyframes signal { 0% { opacity: 0.3; height: 6px; } 100% { opacity: 1; height: 14px; } }


.hero { margin-bottom: 80px; position: relative; z-index: 2; }
.hero h1 {
  font-size: clamp(3rem, 7vw, 6rem); font-weight: 900;
  text-transform: uppercase; line-height: 0.9; letter-spacing: -2px;
  background: linear-gradient(180deg, #fff, #666);
  -webkit-background-clip: text; color: transparent;
}
.hero p { font-family: 'JetBrains Mono'; color: var(--accent); margin-top: 20px; letter-spacing: 1px; }

/* --- CARDS --- */
.grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px; }

.card {
  height: 340px;
  background: var(--surface);
  border: 1px solid var(--border);
  backdrop-filter: blur(10px);
  padding: 30px;
  border-radius: 20px;
  position: relative;
  transition: 0.3s;
  overflow: hidden;
}
.card:hover {
  transform: translateY(-5px);
  border-color: rgba(255,255,255,0.2);
  box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
}
/* Holographic corner accents */
.card::after {
  content:''; position: absolute; top: 0; right: 0;
  width: 30px; height: 30px;
  border-top: 2px solid var(--accent);
  border-right: 2px solid var(--accent);
  opacity: 0; transition: 0.3s;
}
.card:hover::after { opacity: 1; }

.card-title { font-size: 32px; font-weight: 300; margin-top: auto; }
.card-meta { font-family: 'JetBrains Mono'; color: var(--text-muted); font-size: 12px; }

.hidden-content { display: none; } /* Stored data for modal */

/* --- THE FLIP MODAL --- */
.clone-wrapper {
  position: fixed; z-index: 1000;
  background: #08080a;
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 50px 100px rgba(0,0,0,0.9);
  transform-origin: top left;
  overflow: hidden;
  will-change: transform, width, height, top, left;
  transition: all 0.6s var(--ease-out-expo); /* The Open Animation */
}

/* Modal Inner Content */
.modal-inner {
  opacity: 0; transform: translateY(20px);
  transition: opacity 0.3s 0.2s, transform 0.3s 0.2s;
  padding: 60px 40px; height: 100%;
  background: radial-gradient(circle at top right, rgba(112, 0, 255, 0.1), transparent 50%);
}
.clone-wrapper.expanded .modal-inner { opacity: 1; transform: translateY(0); }

/* The CLOSING State overrides */
.clone-wrapper.is-closing {
  transition: all 0.5s var(--ease-in-back); /* Snappier close */
  border-color: transparent;
}
.clone-wrapper.is-closing .modal-inner {
  opacity: 0; transition: 0.1s; /* Content vanishes instantly */
}

/* --- NEW BUTTONS --- */

/* 1. ORBITAL CLOSE BUTTON */
.btn-orbital {
  position: absolute; top: 30px; right: 30px;
  width: 50px; height: 50px;
  background: transparent; border: none;
  display: grid; place-items: center;
  z-index: 10;
  opacity: 0; transform: scale(0.5) rotate(-90deg);
  transition: opacity 0.4s 0.3s, transform 0.4s 0.3s;
}
.clone-wrapper.expanded .btn-orbital { opacity: 1; transform: scale(1) rotate(0); }
/* The fade out logic */
.clone-wrapper.is-closing .btn-orbital { 
  opacity: 0; transform: scale(0.5); transition: 0.2s; 
}

.orb-ring {
  position: absolute; inset: 0; border: 1px dashed var(--accent); border-radius: 50%;
  animation: spin 10s linear infinite;
}
.orb-center { font-size: 20px; color: #fff; }
.btn-orbital:hover .orb-ring { border-style: solid; box-shadow: 0 0 15px var(--accent-glow); animation-duration: 2s; }

/* 2. CYBER DOCK BUTTONS */
.dock-container {
  position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
  display: flex; gap: 12px; z-index: 500;
  transition: 0.4s var(--ease-out-expo);
}
body.modal-open .dock-container { transform: translate(-50%, 150%); }

.cyber-btn {
  position: relative;
  width: 60px; height: 60px;
  background: rgba(20, 20, 20, 0.6);
  backdrop-filter: blur(10px);
  border: none;
  color: var(--text-muted);
  clip-path: polygon(12px 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%, 0 12px);
  transition: 0.3s;
  display: flex; align-items: center; justify-content: center;
}
/* Scanline effect inside button */
.cyber-btn::before {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(180deg, transparent, var(--accent), transparent);
  height: 20%; top: -20%; opacity: 0.3;
  transition: 0.5s;
}
.cyber-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }
.cyber-btn:hover::before { top: 120%; } /* Scan down on hover */

.cyber-btn::after { /* Corner Tick */
  content:''; position: absolute; bottom: 2px; right: 2px;
  width: 4px; height: 4px; background: var(--accent); opacity: 0;
}
.cyber-btn.active { color: var(--accent); border: 1px solid rgba(0, 243, 255, 0.3); }
.cyber-btn.active::after { opacity: 1; }

@keyframes spin { 100% { transform: rotate(360deg); } }

/* --- MODAL CONTENT STYLES --- */
.m-label { font-family: 'JetBrains Mono'; color: var(--accent); font-size: 14px; margin-bottom: 10px; display:block;}
.m-title { font-size: 60px; font-weight: 900; line-height: 0.9; margin-bottom: 40px; text-transform: uppercase; }
.data-row { 
  display: flex; justify-content: space-between; border-bottom: 1px solid var(--border); padding: 20px 0;
  font-family: 'JetBrains Mono'; font-size: 14px;
}

</style>
</head>
<body>

<div class="vignette"></div>
<div class="scanline"></div>
<div class="bg-grid"></div>

<!-- Custom Cursor -->
<div id="cursor"><div class="c-dot"></div><div class="c-ring"></div></div>

<!-- NEW: ADVANCED SEARCH BAR -->
<div class="search-wrapper hover-target">
  <div class="search-glass">
    <svg class="s-icon" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
    <input type="text" id="cmdInput" class="s-input" placeholder="INITIATE SEARCH_">
    <div class="s-key">CTRL K</div>
    <div class="s-signal">
      <div class="sig-bar"></div>
      <div class="sig-bar"></div>
      <div class="sig-bar"></div>
    </div>
  </div>
</div>

<!-- NEW: TELEMETRY SCROLL HUD -->
<div class="scroll-hud">
  <div class="scroll-readout" id="scrollPerc">00%</div>
  <div class="velocity-bar" id="scrollVel"></div>
  <div class="scroll-line"></div>
  <div class="scroll-progress" id="scrollBar"></div>
</div>

<div id="app-root">
  <section class="hero">
    <p>> System 7.0</p>
    <h1>Next Gen<br>Interface</h1>
  </section>

  <div class="grid">
    <!-- Duplicate cards to create scrollable content -->
    <div class="card hover-target" onclick="expand(this)">
      <div class="card-meta">01 // OPERATOR</div>
      <div style="height: 100%; display: flex; flex-direction: column; justify-content: flex-end;">
        <h3 class="card-title">TEST</h3>
      </div>
      <div class="hidden-content">
        <span class="m-label">UNIT ANALYSIS</span>
        <h1 class="m-title">TEST<br>OPERATOR</h1>
        <div class="data-row"><span>STATUS</span><span style="color:#0f0">ONLINE</span></div>
        <div class="data-row"><span>KINETIC ENERGY</span><span>98%</span></div>
      </div>
    </div>
    
    <div class="card hover-target" onclick="expand(this)">
      <div class="card-meta">02 // PROTOCOL</div>
      <div style="height: 100%; display: flex; flex-direction: column; justify-content: flex-end;">
        <h3 class="card-title">VEX</h3>
      </div>
       <div class="hidden-content">
        <span class="m-label">DEFENSE PROTOCOL</span>
        <h1 class="m-title">VEX<br>SYSTEM</h1>
        <div class="data-row"><span>SHIELD INTEGRITY</span><span>100%</span></div>
      </div>
    </div>
    
    <div class="card hover-target" onclick="expand(this)">
       <div class="card-meta">03 // EVENT</div>
      <div style="height: 100%; display: flex; flex-direction: column; justify-content: flex-end;">
        <h3 class="card-title">WAR</h3>
      </div>
      <div class="hidden-content">
        <span class="m-label">ACTIVE CONFLICT</span>
        <h1 class="m-title">DOMINATION</h1>
        <div class="data-row" style="color:var(--accent)">VICTORY IMMINENT</div>
      </div>
    </div>

    <!-- Extra Cards for Scrolling -->
    <div class="card hover-target"><div class="card-meta">04 // NULL</div><div style="height: 100%; display: flex; flex-direction: column; justify-content: flex-end;"><h3 class="card-title">ECHO</h3></div></div>
    <div class="card hover-target"><div class="card-meta">05 // NULL</div><div style="height: 100%; display: flex; flex-direction: column; justify-content: flex-end;"><h3 class="card-title">STATIC</h3></div></div>
    <div class="card hover-target"><div class="card-meta">06 // NULL</div><div style="height: 100%; display: flex; flex-direction: column; justify-content: flex-end;"><h3 class="card-title">VOID</h3></div></div>
  </div>
</div>

<!-- DOCK -->
<div class="dock-container">
  <button class="cyber-btn active hover-target"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"/></svg></button>
  <button class="cyber-btn hover-target"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg></button>
  <button class="cyber-btn hover-target"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a10 10 0 1 0 10 10"/></svg></button>
</div>

<script>
/* --- CURSOR LOGIC --- */
const cursor = document.getElementById('cursor');
const ring = cursor.querySelector('.c-ring');
let mouseX = -100, mouseY = -100;

document.addEventListener('mousemove', e => { 
  mouseX = e.clientX; mouseY = e.clientY; 
  cursor.querySelector('.c-dot').style.transform = `translate(${mouseX}px, ${mouseY}px) translate(-50%, -50%)`;
});

// Physics-based ring lag
let ringX = 0, ringY = 0;
function loop() {
  ringX += (mouseX - ringX) * 0.15;
  ringY += (mouseY - ringY) * 0.15;
  ring.style.transform = `translate(${ringX}px, ${ringY}px) translate(-50%, -50%)`;
  requestAnimationFrame(loop);
}
loop();

// Hover Interactions
document.querySelectorAll('.hover-target').forEach(el => {
  el.addEventListener('mouseenter', () => ring.classList.add('active'));
  el.addEventListener('mouseleave', () => ring.classList.remove('active'));
});

/* --- SEARCH BAR LOGIC --- */
const searchWrapper = document.querySelector('.search-wrapper');
const cmdInput = document.getElementById('cmdInput');

// Focus Handlers
cmdInput.addEventListener('focus', () => searchWrapper.classList.add('focused'));
cmdInput.addEventListener('blur', () => {
  if(cmdInput.value === '') searchWrapper.classList.remove('focused');
  searchWrapper.classList.remove('typing');
});

// Typing visualizer
cmdInput.addEventListener('input', (e) => {
  if(e.target.value.length > 0) searchWrapper.classList.add('typing');
  else searchWrapper.classList.remove('typing');
});

// Hotkey Listener (Ctrl + K)
document.addEventListener('keydown', e => {
  if((e.ctrlKey || e.metaKey) && e.key === 'k') {
    e.preventDefault();
    cmdInput.focus();
  }
});

/* --- SCROLL HUD LOGIC --- */
const appRoot = document.getElementById('app-root');
const scrollBar = document.getElementById('scrollBar');
const scrollPerc = document.getElementById('scrollPerc');
const scrollVel = document.getElementById('scrollVel');

let lastScrollTop = 0;
let scrollTimeout;

appRoot.addEventListener('scroll', () => {
  // 1. Calculate Percentage
  const scrollTop = appRoot.scrollTop;
  const scrollHeight = appRoot.scrollHeight - appRoot.clientHeight;
  const scrolled = (scrollTop / scrollHeight) * 100;
  
  scrollBar.style.height = scrolled + '%';
  scrollPerc.innerText = Math.round(scrolled).toString().padStart(2, '0') + '%';

  // 2. Calculate Velocity (Physics Effect)
  const velocity = Math.abs(scrollTop - lastScrollTop);
  const scale = Math.min(1 + (velocity * 0.1), 4); // Cap stretching
  const opacity = Math.min(0.2 + (velocity * 0.05), 1);
  
  scrollVel.style.transform = `scaleX(${scale})`;
  scrollVel.style.opacity = opacity;
  
  lastScrollTop = scrollTop;

  // Reset velocity visual when stopped
  clearTimeout(scrollTimeout);
  scrollTimeout = setTimeout(() => {
    scrollVel.style.transform = 'scaleX(1)';
    scrollVel.style.opacity = '0.3';
  }, 100);
});

/* --- FLIP ANIMATION 2.0 (Existing) --- */
let activeClone = null;
let originalCard = null;

function expand(card) {
  if(activeClone) return;
  originalCard = card;
  const rect = card.getBoundingClientRect();

  // Create Clone
  const clone = document.createElement('div');
  clone.className = 'clone-wrapper';
  clone.style.top = rect.top + 'px';
  clone.style.left = rect.left + 'px';
  clone.style.width = rect.width + 'px';
  clone.style.height = rect.height + 'px';
  
  // Inject Content
  const content = card.querySelector('.hidden-content').innerHTML;
  clone.innerHTML = `
    <button class="btn-orbital hover-target" onclick="collapse()">
      <div class="orb-ring"></div>
      <div class="orb-center">âœ•</div>
    </button>
    <div class="modal-inner">
      ${content}
    </div>
  `;

  document.body.appendChild(clone);

  // FLIP Execution
  requestAnimationFrame(() => {
    card.style.opacity = 0;
    document.body.classList.add('modal-open');

    requestAnimationFrame(() => {
      clone.classList.add('expanded');
      
      const isMobile = window.innerWidth < 768;
      const w = isMobile ? window.innerWidth * 0.9 : 800;
      const h = isMobile ? window.innerHeight * 0.8 : 600;
      
      clone.style.width = w + 'px';
      clone.style.height = h + 'px';
      clone.style.top = (window.innerHeight - h)/2 + 'px';
      clone.style.left = (window.innerWidth - w)/2 + 'px';
      
      // Re-bind hover
      const newBtn = clone.querySelector('.btn-orbital');
      newBtn.addEventListener('mouseenter', () => ring.classList.add('active'));
      newBtn.addEventListener('mouseleave', () => ring.classList.remove('active'));
    });
  });
  
  activeClone = clone;
}

function collapse() {
  if(!activeClone) return;
  const rect = originalCard.getBoundingClientRect();

  activeClone.classList.add('is-closing');
  activeClone.classList.remove('expanded');

  setTimeout(() => {
    document.body.classList.remove('modal-open');
    activeClone.style.width = rect.width + 'px';
    activeClone.style.height = rect.height + 'px';
    activeClone.style.top = rect.top + 'px';
    activeClone.style.left = rect.left + 'px';
  }, 50); 

  setTimeout(() => {
    if(activeClone) activeClone.remove();
    if(originalCard) originalCard.style.opacity = 1;
    activeClone = null;
    originalCard = null;
  }, 600);
}

document.addEventListener('keydown', e => { if(e.key === 'Escape') collapse(); });

</script>
</body>
</html>

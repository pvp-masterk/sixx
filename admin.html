<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>/six Admin</title>

<!-- Fonts & Icons -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/@phosphor-icons/web"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
/* ======================= CORE VARIABLES ======================= */
:root {
  --bg-deep: #030005;
  --bg-panel: #0a0510;
  --bg-card: #11081a;
  
  --glass-surface: rgba(20, 10, 35, 0.6);
  --glass-border: rgba(255, 255, 255, 0.06);
  --glass-highlight: rgba(255, 255, 255, 0.1);

  --accent-primary: #8b2fc9;
  --accent-glow: #b05ce6;
  --accent-secondary: #4361ee;
  
  --text-main: #ececf1;
  --text-muted: #8a8896;
  
  --s-founder: #ffd60a;
  --s-admin: #f72585;
  --s-mod: #4cc9f0;
  --s-user: #8a8896;

  --ease-out: cubic-bezier(0.23, 1, 0.32, 1);
}

/* ======================= RESET & BASE ======================= */
* { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; }
body {
  font-family: 'Inter', sans-serif;
  background-color: var(--bg-deep);
  color: var(--text-main);
  height: 100vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Background Atmosphere */
.ambient-light {
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;
  background: 
    radial-gradient(circle at 10% 20%, rgba(139, 47, 201, 0.08) 0%, transparent 40%),
    radial-gradient(circle at 90% 80%, rgba(67, 97, 238, 0.08) 0%, transparent 40%);
  pointer-events: none;
}

/* Scrollbar */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--accent-primary); }

/* ======================= LAYOUT ======================= */
.app-shell {
  max-width: 1600px; width: 100%; margin: 0 auto;
  padding: 20px; flex: 1; display: flex; flex-direction: column; gap: 20px;
  height: 100%;
}

/* Header */
.top-nav {
  display: flex; justify-content: space-between; align-items: center;
  padding: 16px 24px;
  background: var(--glass-surface);
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.2);
}

.brand-logo {
  font-family: 'JetBrains Mono', monospace; font-weight: 800; font-size: 22px;
  letter-spacing: -1px;
  background: linear-gradient(135deg, #fff 0%, var(--accent-glow) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  display: flex; align-items: center; gap: 10px;
}
.brand-tag {
  font-size: 10px; background: rgba(255,255,255,0.1); color: #fff;
  padding: 3px 6px; border-radius: 4px; border: 1px solid var(--glass-border);
  font-family: 'Inter'; font-weight: 600; text-transform: uppercase;
}

/* User Profile in Header */
.nav-profile { display: flex; align-items: center; gap: 12px; }
.nav-profile img { 
  width: 40px; height: 40px; border-radius: 12px; object-fit: cover; 
  border: 1px solid var(--glass-border); box-shadow: 0 0 10px rgba(0,0,0,0.3);
}
.nav-text { text-align: right; line-height: 1.3; }
.nav-name { font-weight: 700; font-size: 14px; color: #fff; }
.nav-role { font-size: 11px; color: var(--accent-glow); font-weight: 600; letter-spacing: 0.5px; }

/* Stats Bar */
.stats-bar {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;
}
.stat-card {
  background: var(--glass-surface); border: 1px solid var(--glass-border);
  padding: 15px 20px; border-radius: 12px; display: flex; flex-direction: column;
  position: relative; overflow: hidden;
}
.stat-card::after {
  content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%;
  background: var(--accent-primary);
}
.stat-val { font-size: 24px; font-weight: 800; color: #fff; font-family: 'JetBrains Mono'; }
.stat-label { font-size: 12px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; margin-top: 4px; }

/* Toolbar */
.toolbar {
  display: flex; gap: 15px; align-items: center; flex-wrap: wrap;
}
.search-wrapper {
  position: relative; flex: 1; min-width: 300px;
}
.search-icon {
  position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
  color: var(--text-muted); font-size: 18px; pointer-events: none;
}
.custom-input {
  width: 100%; background: rgba(255,255,255,0.03);
  border: 1px solid var(--glass-border);
  padding: 14px 14px 14px 48px; border-radius: 12px;
  color: #fff; font-family: 'Inter'; font-size: 14px;
  transition: all 0.3s var(--ease-out);
}
.custom-input:focus {
  background: rgba(255,255,255,0.07);
  border-color: var(--accent-primary);
  box-shadow: 0 0 0 4px rgba(139, 47, 201, 0.15);
}

/* Buttons */
.btn {
  background: rgba(255,255,255,0.03); border: 1px solid var(--glass-border);
  color: var(--text-main); padding: 0 18px; height: 46px;
  border-radius: 10px; font-size: 13px; font-weight: 600;
  display: flex; align-items: center; gap: 8px; cursor: pointer;
  transition: all 0.2s;
}
.btn:hover { background: rgba(255,255,255,0.08); transform: translateY(-2px); }
.btn:active { transform: translateY(0); }
.btn.glow { 
  background: linear-gradient(135deg, var(--accent-primary), #6a1b9a);
  border: none; color: #fff; box-shadow: 0 4px 15px rgba(139, 47, 201, 0.4);
}
.btn.glow:hover { box-shadow: 0 6px 20px rgba(139, 47, 201, 0.6); }

/* ======================= GRID & JOINT CARDS ======================= */
.grid-container {
  flex: 1; overflow-y: auto; padding-right: 8px; position: relative;
}
.user-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px;
  padding-bottom: 60px;
}

/* The Joint Card */
.card {
  position: relative;
  background: var(--bg-card);
  border: 1px solid var(--glass-border);
  border-radius: 16px; overflow: hidden;
  transition: transform 0.3s var(--ease-out), box-shadow 0.3s var(--ease-out);
  display: flex; flex-direction: column;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  border-color: var(--accent-primary);
}

/* Banner Section */
.card-banner {
  height: 90px;
  background-color: #1a1a2e;
  background-size: cover; background-position: center;
  position: relative;
}
.card-banner::after {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(to bottom, transparent, rgba(17, 8, 26, 0.9));
}

/* Body Section with Overlap */
.card-body {
  padding: 0 20px 20px 20px;
  display: flex; flex-direction: column; gap: 6px;
  margin-top: -40px; /* The Overlap Magic */
  position: relative; z-index: 2;
  flex: 1;
}

.card-avatar {
  width: 72px; height: 72px;
  border-radius: 18px;
  border: 4px solid var(--bg-card);
  background: #000; object-fit: cover;
  box-shadow: 0 5px 15px rgba(0,0,0,0.4);
}

.card-identity {
  margin-top: 8px;
}
.card-name { font-size: 16px; font-weight: 700; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-id { 
  font-family: 'JetBrains Mono', monospace; font-size: 11px; 
  color: var(--text-muted); display: flex; align-items: center; gap: 4px; cursor: pointer;
  transition: color 0.2s;
}
.card-id:hover { color: var(--accent-glow); }

/* Badges */
.card-badges { display: flex; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
.badge {
  font-size: 10px; font-weight: 700; padding: 4px 8px; border-radius: 6px;
  text-transform: uppercase; letter-spacing: 0.5px;
  display: flex; align-items: center; gap: 4px;
}

/* Role Specific Colors */
.badge.founder { background: rgba(255, 214, 10, 0.15); color: var(--s-founder); border: 1px solid rgba(255,214,10,0.3); }
.badge.admin { background: rgba(247, 37, 133, 0.15); color: var(--s-admin); border: 1px solid rgba(247,37,133,0.3); }
.badge.moderator { background: rgba(76, 201, 240, 0.15); color: var(--s-mod); border: 1px solid rgba(76,201,240,0.3); }
.badge.user { background: rgba(255, 255, 255, 0.05); color: var(--text-muted); border: 1px solid var(--glass-border); }

.card-footer {
  margin-top: auto; padding-top: 15px;
  display: flex; gap: 10px; border-top: 1px solid rgba(255,255,255,0.05);
}

.action-btn {
  flex: 1; padding: 8px; border-radius: 8px; border: 1px solid var(--glass-border);
  background: transparent; color: var(--text-muted); cursor: pointer;
  font-size: 12px; font-weight: 600; transition: 0.2s;
  display: flex; justify-content: center; align-items: center; gap: 6px;
}
.action-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }
.action-btn.primary:hover { background: var(--accent-primary); border-color: var(--accent-primary); }

/* ======================= MODALS ======================= */
.modal-overlay {
  position: fixed; inset: 0; z-index: 2000;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
  display: flex; justify-content: center; align-items: center;
  opacity: 0; pointer-events: none; transition: opacity 0.3s;
}
.modal-overlay.active { opacity: 1; pointer-events: auto; }

/* Logs Modal Unique Style */
.logs-modal {
  width: 600px; max-width: 90%; max-height: 80vh;
  background: #0d0614;
  border: 1px solid var(--glass-border);
  box-shadow: 0 0 50px rgba(139, 47, 201, 0.15);
  border-radius: 20px;
  display: flex; flex-direction: column;
  transform: translateY(20px); transition: transform 0.3s var(--ease-out);
  overflow: hidden;
}
.modal-overlay.active .logs-modal { transform: translateY(0); }

.logs-header {
  padding: 20px 25px;
  background: linear-gradient(90deg, rgba(139,47,201,0.1), transparent);
  border-bottom: 1px solid var(--glass-border);
  display: flex; justify-content: space-between; align-items: center;
}
.logs-header h2 { font-family: 'JetBrains Mono'; font-size: 18px; color: #fff; display: flex; align-items: center; gap: 10px; }

.logs-content {
  padding: 25px; overflow-y: auto;
  position: relative;
}
/* Timeline Style */
.timeline {
  border-left: 2px solid rgba(255,255,255,0.1);
  padding-left: 20px; margin-left: 10px;
}
.changelog-item {
  position: relative; margin-bottom: 30px;
}
.changelog-item::before {
  content: ''; position: absolute; left: -26px; top: 0;
  width: 10px; height: 10px; background: var(--accent-primary);
  border-radius: 50%; box-shadow: 0 0 10px var(--accent-primary);
}
.log-date { font-size: 11px; color: var(--accent-glow); margin-bottom: 4px; font-family: 'JetBrains Mono'; }
.log-version { color: #fff; font-weight: 700; font-size: 15px; margin-bottom: 8px; }
.log-desc { font-size: 13px; color: var(--text-muted); line-height: 1.5; }
.log-badge { display: inline-block; font-size: 10px; padding: 2px 6px; border-radius: 4px; background: rgba(255,255,255,0.1); margin-right: 5px; }
.log-badge.new { background: var(--accent-primary); color: #fff; }

/* ======================= TOAST & EXTRAS ======================= */
.toast-box {
  position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 10px; z-index: 3000;
}
.toast {
  background: rgba(15, 10, 25, 0.95); border: 1px solid var(--glass-border);
  padding: 12px 20px; border-radius: 8px; color: #fff; font-size: 13px; font-weight: 500;
  border-left: 3px solid var(--accent-primary);
  box-shadow: 0 10px 30px rgba(0,0,0,0.6);
  animation: slideIn 0.3s forwards;
}
@keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

/* Skeleton Loading */
.skeleton { background: #1a1a2e; animation: pulse 1.5s infinite; }
@keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }

</style>
</head>
<body>

<div class="ambient-light"></div>

<div class="app-shell">
  
  <!-- Header -->
  <header class="top-nav">
    <div class="brand-logo">
      <i class="ph-fill ph-hexagon"></i>
      /six ADMIN <span class="brand-tag">v1</span>
    </div>
    
    <div class="nav-profile">
      <div class="nav-text">
        <div class="nav-name" id="my-username">Loading...</div>
        <div class="nav-role" id="my-role">SYSTEM</div>
      </div>
      <img id="my-avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Profile">
      <button class="btn" style="width:40px; padding:0; justify-content:center;" onclick="app.toggleLogs()">
        <i class="ph ph-bell"></i>
      </button>
    </div>
  </header>

  <!-- Live Stats -->
  <div class="stats-bar">
    <div class="stat-card">
      <div class="stat-val" id="stat-total">0</div>
      <div class="stat-label">Total Users</div>
    </div>
    <div class="stat-card" style="--accent-primary:#f72585;">
      <div class="stat-val" id="stat-admins">0</div>
      <div class="stat-label">Administrators</div>
    </div>
    <div class="stat-card" style="--accent-primary:#4cc9f0;">
      <div class="stat-val" id="stat-new">0</div>
      <div class="stat-label">New Today</div>
    </div>
  </div>

  <!-- Controls -->
  <div class="toolbar">
    <div class="search-wrapper">
      <i class="ph ph-magnifying-glass search-icon"></i>
      <input type="text" class="custom-input" id="search-input" placeholder="Search by UUID, Username, or IP..." onkeyup="app.handleSearch()">
    </div>
    
    <select class="custom-input" style="width: 150px; cursor: pointer;" id="role-filter" onchange="app.filterByRole()">
      <option value="all">All Roles</option>
      <option value="founder">Founders</option>
      <option value="admin">Admins</option>
      <option value="moderator">Moderators</option>
      <option value="user">Users</option>
    </select>

    <div style="flex:1;"></div>

    <button class="btn" onclick="app.refreshData()"><i class="ph ph-arrows-clockwise"></i> Refresh</button>
    <button class="btn glow" onclick="ui.toast('Invite Generated')"><i class="ph ph-plus"></i> New User</button>
  </div>

  <!-- Main Grid -->
  <div class="grid-container">
    <div id="user-grid" class="user-grid">
      <!-- Cards rendered here -->
    </div>
  </div>

</div>

<!-- Update Logs Modal -->
<div id="logs-modal" class="modal-overlay">
  <div class="logs-modal">
    <div class="logs-header">
      <h2><i class="ph-fill ph-read-cv-logo"></i> System Changelog</h2>
      <button class="btn" style="width:36px; padding:0; justify-content:center;" onclick="app.toggleLogs()"><i class="ph ph-x"></i></button>
    </div>
    <div class="logs-content">
      <div class="timeline" id="changelog-list">
        <!-- Logs injected via JS -->
      </div>
    </div>
  </div>
</div>

<!-- Toast Container -->
<div class="toast-box" id="toast-container"></div>

<script>
// ==================== CONFIGURATION ====================
const CONFIG = {
  supabaseUrl: "https://tstsijdifhgmpaszqknr.supabase.co",
  supabaseKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRzdHNpamRpZmhnbXBhc3pxa25yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI5NzA1NTIsImV4cCI6MjA3ODU0NjU1Mn0.8AvcLNL-6PIlfw2FUeLcMC9atefZmZAyUQBOquGpVo4",
  defaultBanner: "https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?w=500&auto=format&fit=crop&q=60",
  defaultAvatar: "https://cdn.discordapp.com/embed/avatars/0.png"
};

const supabaseClient = supabase.createClient(CONFIG.supabaseUrl, CONFIG.supabaseKey);

// ==================== STATE MANAGEMENT ====================
const STATE = {
  allUsers: [],
  displayUsers: [],
  currentUser: null,
  roleFilter: 'all'
};

const CHANGELOGS = [
  { ver: "2.1.0", date: "Jan 25, 2025", items: ["Added Banner Support to Cards", "Optimized Grid Performance", "New Glassmorphism UI"] },
  { ver: "2.0.5", date: "Jan 20, 2025", items: ["Fixed Auth Lag", "Added Moderator Role badge"] },
  { ver: "1.9.0", date: "Jan 10, 2025", items: ["Initial Release of Admin Panel"] }
];

// ==================== APP LOGIC ====================
const app = {
  init: async () => {
    ui.renderSkeleton();
    ui.renderChangelog();
    await app.fetchUser();
    await app.fetchData();
  },

  // Get Current Admin Info
  fetchUser: async () => {
    // Simulated Check (Replace with actual auth check if needed)
    STATE.currentUser = { username: 'Operator', role: 'founder', avatar: CONFIG.defaultAvatar };
    
    // Attempt actual Supabase Auth get
    const { data: { user } } = await supabaseClient.auth.getUser();
    if(user) {
      const { data } = await supabaseClient.from('profiles').select('*').eq('id', user.id).single();
      if(data) STATE.currentUser = data;
    }

    document.getElementById('my-username').textContent = STATE.currentUser.username || 'Admin';
    document.getElementById('my-role').textContent = (STATE.currentUser.role || 'Superuser').toUpperCase();
    document.getElementById('my-avatar').src = STATE.currentUser.avatar || CONFIG.defaultAvatar;
  },

  // Fetch All Users
  fetchData: async () => {
    const { data, error } = await supabaseClient
      .from('profiles')
      .select('*')
      .order('created_at', { ascending: false });

    if(error) {
      console.error(error);
      ui.toast('Connection Failed: Showing Demo Data', 'error');
      // If DB fails/empty, show nothing or demo data. currently shows empty grid.
      document.getElementById('user-grid').innerHTML = '<div style="color:#666; padding:20px;">No users found or connection error.</div>';
      return;
    }

    STATE.allUsers = data || [];
    STATE.displayUsers = [...STATE.allUsers];
    app.calculateStats();
    ui.renderGrid();
  },

  calculateStats: () => {
    const total = STATE.allUsers.length;
    const admins = STATE.allUsers.filter(u => ['admin','founder'].includes(u.role)).length;
    // Mocking "New Today" based on random for visual demo as real dates vary
    const today = STATE.allUsers.filter(u => new Date(u.created_at) > new Date(Date.now() - 86400000)).length;

    ui.animateValue('stat-total', 0, total, 1000);
    ui.animateValue('stat-admins', 0, admins, 1000);
    ui.animateValue('stat-new', 0, today, 1000);
  },

  handleSearch: () => {
    clearTimeout(window.searchDebounce);
    window.searchDebounce = setTimeout(() => {
      const term = document.getElementById('search-input').value.toLowerCase();
      app.applyFilters(term);
    }, 300); // 300ms debounce prevents lag
  },

  filterByRole: () => {
    STATE.roleFilter = document.getElementById('role-filter').value;
    app.handleSearch(); // Re-trigger search logic with new filter
  },

  applyFilters: (term = '') => {
    STATE.displayUsers = STATE.allUsers.filter(u => {
      const matchesSearch = (u.username && u.username.toLowerCase().includes(term)) || 
                            (u.id && u.id.includes(term));
      const matchesRole = STATE.roleFilter === 'all' || u.role === STATE.roleFilter;
      return matchesSearch && matchesRole;
    });
    ui.renderGrid();
  },

  refreshData: () => {
    ui.renderSkeleton();
    app.fetchData();
    ui.toast('System Data Refreshed');
  },

  toggleLogs: () => {
    document.getElementById('logs-modal').classList.toggle('active');
  },

  getAction: (uid, action) => {
    if(action === 'copy') {
      navigator.clipboard.writeText(uid);
      ui.toast('UUID Copied to Clipboard');
    }
    if(action === 'edit') {
      ui.toast('Edit Modal Opening...', 'neutral');
      // Logic for edit modal would go here
    }
  }
};

// ==================== UI RENDERING ====================
const ui = {
  renderGrid: () => {
    const grid = document.getElementById('user-grid');
    grid.innerHTML = ''; // Clear current

    if(STATE.displayUsers.length === 0) {
      grid.innerHTML = '<div style="color:var(--text-muted); grid-column:1/-1; text-align:center; padding-top:40px;">No Data Found</div>';
      return;
    }

    // Optimization: DocumentFragment for single reflow
    const fragment = document.createDocumentFragment();

    STATE.displayUsers.forEach(u => {
      const card = document.createElement('div');
      card.className = 'card';
      
      const bannerImg = u.banner || CONFIG.defaultBanner;
      const avatarImg = u.avatar || CONFIG.defaultAvatar;
      const role = u.role || 'user';
      
      card.innerHTML = `
        <div class="card-banner" style="background-image: url('${bannerImg}')"></div>
        <div class="card-body">
          <img src="${avatarImg}" class="card-avatar" loading="lazy">
          
          <div class="card-identity">
            <div class="card-name">${u.username || 'Unknown'}</div>
            <div class="card-id" onclick="app.getAction('${u.id}', 'copy')">
              <i class="ph ph-fingerprint"></i> ${u.id.substring(0,8)}...
            </div>
          </div>

          <div class="card-badges">
            <span class="badge ${role}"><i class="ph-fill ph-shield"></i> ${role.toUpperCase()}</span>
            ${role === 'founder' ? '<span class="badge" style="border-color:#ffd60a; color:#ffd60a;">OWNER</span>' : ''}
          </div>

          <div class="card-footer">
            <button class="action-btn primary" onclick="app.getAction('${u.id}','edit')">Manage</button>
            <button class="action-btn" title="Copy ID" onclick="app.getAction('${u.id}','copy')"><i class="ph ph-copy"></i></button>
            <button class="action-btn" title="Ban User" style="color:#f72585;"><i class="ph ph-prohibit"></i></button>
          </div>
        </div>
      `;
      fragment.appendChild(card);
    });

    grid.appendChild(fragment);
  },

  renderSkeleton: () => {
    const grid = document.getElementById('user-grid');
    let html = '';
    for(let i=0; i<8; i++) {
      html += `
      <div class="card" style="pointer-events:none;">
        <div class="card-banner skeleton"></div>
        <div class="card-body">
          <div class="card-avatar skeleton"></div>
          <div style="height:20px; width:60%; margin-top:10px;" class="skeleton"></div>
          <div style="height:15px; width:40%; margin-top:5px;" class="skeleton"></div>
        </div>
      </div>`;
    }
    grid.innerHTML = html;
  },

  renderChangelog: () => {
    const container = document.getElementById('changelog-list');
    let html = '';
    CHANGELOGS.forEach((log, index) => {
      const isNew = index === 0 ? '<span class="log-badge new">LATEST</span>' : '';
      const itemsHtml = log.items.map(i => `<div>â€¢ ${i}</div>`).join('');
      html += `
        <div class="changelog-item">
          <div class="log-date">${log.date}</div>
          <div class="log-version">${isNew} v${log.ver}</div>
          <div class="log-desc">${itemsHtml}</div>
        </div>
      `;
    });
    container.innerHTML = html;
  },

  animateValue: (id, start, end, duration) => {
    if (start === end) return;
    const range = end - start;
    let current = start;
    const increment = end > start ? 1 : -1;
    const stepTime = Math.abs(Math.floor(duration / range));
    const obj = document.getElementById(id);
    
    // Fallback for massive numbers to avoid freezing
    if(range > 100) { obj.innerText = end; return; }

    const timer = setInterval(function() {
      current += increment;
      obj.innerText = current;
      if (current == end) clearInterval(timer);
    }, stepTime);
  },

  toast: (msg, type='success') => {
    const box = document.getElementById('toast-container');
    const t = document.createElement('div');
    t.className = 'toast';
    t.innerText = msg;
    if(type === 'error') t.style.borderLeftColor = '#ff0054';
    box.appendChild(t);
    setTimeout(() => {
      t.style.opacity = '0';
      t.style.transform = 'translateY(20px)';
      setTimeout(() => t.remove(), 300);
    }, 3000);
  }
};

// Start
window.addEventListener('DOMContentLoaded', app.init);

</script>
</body>
</html>
